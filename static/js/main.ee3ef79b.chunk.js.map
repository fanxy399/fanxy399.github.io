{"version":3,"sources":["utils/index.ts","utils/http.ts","utils/useAsync.ts","components/Profiler.tsx","components/ErrorBoundary.tsx","App.tsx","reportWebVitals.ts","context/index.tsx","index.tsx","auth-provider.ts","components/lib.tsx","context/auth-context.tsx"],"names":["cleanObject","object","result","Object","keys","forEach","el","value","undefined","useMount","callback","useEffect","useDebounce","delay","useState","debounceValue","setDebounceValue","timeout","setTimeout","clearTimeout","useDoucmentTitle","title","keepOnUnmount","oldTitle","useRef","document","current","resetRoute","window","location","href","origin","useMountedRef","mountedRef","apiUrl","process","http","endpoint","a","data","token","headers","customConfig","config","method","Authorization","toUpperCase","qs","stringify","body","JSON","fetch","then","reponse","status","logout","reload","Promise","reject","message","json","ok","useHttp","user","useAuth","useCallback","defaultInitialState","stat","error","defaultConfig","throwOnError","useAsync","initialState","initialConfig","useReducer","state","action","safeDispatch","dispatch","useSafeDispatch","reTry","setReTry","setData","setError","run","promise","runConfig","Error","retry","res","catch","err","isIdle","isSuccess","isError","isLoading","queue","setInterval","length","queueToSend","console","log","Profiler","metadata","phases","props","onRender","id","phase","actualDuration","baseDuration","startTime","commitTime","interactions","includes","push","ErrorBoundary","this","fallbackRender","children","Component","Authenticated","React","lazy","Unauthenticated","App","className","FullPageErrorFallback","Suspense","fallback","FullPageLoading","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","AppProvider","queryClient","QueryClient","defaultOptions","queries","refetchOnWindowFocus","QueryClientProvider","client","loadServer","ReactDOM","render","StrictMode","getElementById","API","localStorageKey","localStorage","getItem","handleUserResponse","setItem","register","params","login","removeItem","Row","styled","div","between","marginBottom","gap","FullPage","size","ErrorBox","Text","type","ButtonNoPadding","ScreenContainer","bootstrapUser","auth","AuthContext","createContext","displayName","AuthProvider","setUser","useQueryClient","Provider","form","clear","context","useContext"],"mappings":"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","file":"static/js/main.ee3ef79b.chunk.js","sourcesContent":["import { useEffect, useState, useRef } from \"react\";\n\nexport const isFalsy = (value: unknown) => (value === 0 ? false : !value);\n\nexport const isVoid = (value: unknown) =>\n  value === undefined || value === null || value === \"\";\n\nexport const cleanObject = (object?: { [key: string]: unknown }) => {\n  if (!object) return {};\n  const result = { ...object };\n  Object.keys(result).forEach((el) => {\n    if (isVoid(result[el])) delete result[el];\n  });\n  return result;\n};\n\nexport const useMount = (callback: () => void) => {\n  useEffect(() => {\n    callback();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n};\n\nexport const useDebounce = <V>(value: V, delay?: number) => {\n  const [debounceValue, setDebounceValue] = useState(value);\n  useEffect(() => {\n    const timeout = setTimeout(() => setDebounceValue(value), delay);\n    return () => clearTimeout(timeout);\n  }, [value, delay]);\n  return debounceValue;\n};\n\nexport const useArray = <v>(initArray: v[]) => {\n  const [value, setValue] = useState(initArray);\n  return {\n    value,\n    clean: () => setValue([]),\n    removeIndex: (index: number) => {\n      const copy = [...value];\n      copy.splice(index, 1);\n      setValue(copy);\n    },\n    add: (item: v) => setValue([...value, item]),\n  };\n};\n\nexport const useDoucmentTitle = (\n  title: string,\n  keepOnUnmount: boolean = true\n) => {\n  const oldTitle = useRef(document.title).current;\n  useEffect(() => {\n    document.title = title;\n  }, [title]);\n  useEffect(() => {\n    return () => {\n      if (!keepOnUnmount) document.title = oldTitle;\n    };\n  }, [keepOnUnmount, oldTitle]);\n};\n\nexport const resetRoute = () => (window.location.href = window.location.origin);\n\nexport const useMountedRef = () => {\n  const mountedRef = useRef(false);\n  useEffect(() => {\n    mountedRef.current = true;\n    return () => {\n      mountedRef.current = false;\n    };\n  }, []);\n  return mountedRef;\n};\n","import qs from \"querystring\";\nimport { logout } from \"auth-provider\";\nimport { useAuth } from \"context/auth-context\";\nimport { useCallback } from \"react\";\n\nconst apiUrl = process.env.REACT_APP_API_URL;\ninterface Config extends RequestInit {\n  data?: object;\n  token?: string;\n}\n\nexport const http = async (\n  endpoint: string,\n  { data, token, headers, ...customConfig }: Config = {}\n) => {\n  const config = {\n    method: \"GET\",\n    headers: {\n      Authorization: token ? `Bearer ${token}` : \"\",\n      \"Content-Type\": data ? \"application/json\" : \"\",\n    },\n    ...customConfig,\n  };\n  if (config.method.toUpperCase() === \"GET\") {\n    endpoint += `?${qs.stringify({ ...data })}`;\n  } else {\n    config.body = JSON.stringify(data || {});\n  }\n  return window.fetch(`${apiUrl}/${endpoint}`, config).then(async (reponse) => {\n    if (reponse.status === 401) {\n      await logout();\n      window.location.reload();\n      return Promise.reject({ message: \"请重新登陆\" });\n    }\n    const data = await reponse.json();\n    if (reponse.ok) {\n      return data;\n    } else {\n      return Promise.reject(await reponse.json());\n    }\n  });\n};\n\nexport const useHttp = () => {\n  const { user } = useAuth();\n  return useCallback(\n    (...[endpoint, config]: Parameters<typeof http>) =>\n      http(endpoint, { ...config, token: user?.token }),\n    [user?.token]\n  );\n};\n","import { useState, useCallback, useReducer } from \"react\";\nimport { useMountedRef } from \"utils\";\n\ninterface State<D> {\n  stat: \"idle\" | \"loading\" | \"error\" | \"success\";\n  data: D | null;\n  error: Error | null;\n}\n\nconst defaultInitialState: State<null> = {\n  stat: \"idle\",\n  data: null,\n  error: null,\n};\n\nconst defaultConfig = {\n  throwOnError: false,\n};\n\nconst useSafeDispatch = <T>(dispatch: (...args: T[]) => void) => {\n  const mountedRef = useMountedRef();\n  return useCallback(\n    (...args) => (mountedRef.current ? dispatch(...args) : void 0),\n    [mountedRef, dispatch]\n  );\n};\n\nexport const useAsync = <D>(\n  initialState?: State<D>,\n  initialConfig?: typeof defaultConfig\n) => {\n  const [state, dispatch] = useReducer(\n    (state: State<D>, action: Partial<State<D>>) => ({ ...state, ...action }),\n    {\n      ...defaultInitialState,\n      ...initialState,\n    }\n  );\n  const safeDispatch = useSafeDispatch(dispatch);\n  const config = { ...defaultConfig, ...initialConfig };\n  const [reTry, setReTry] = useState(() => () => {});\n  const setData = useCallback(\n    (data: D) => safeDispatch({ data, stat: \"success\", error: null }),\n    [safeDispatch]\n  );\n  const setError = useCallback(\n    (error: Error) => safeDispatch({ error, data: null, stat: \"error\" }),\n    [safeDispatch]\n  );\n  const run = useCallback(\n    (promise: Promise<D>, runConfig?: { retry: () => Promise<D> }) => {\n      if (!promise || !promise.then) {\n        throw new Error(\"请传入 Promise 类型数据\");\n      }\n      setReTry(() => () => {\n        if (runConfig?.retry) {\n          run(runConfig?.retry(), runConfig);\n        }\n      });\n      safeDispatch({ stat: \"loading\" });\n      return promise\n        .then((res) => {\n          setData(res);\n          return res;\n        })\n        .catch((err) => {\n          setError(err);\n          if (config.throwOnError) return Promise.reject(err);\n          return err;\n        });\n    },\n    [config.throwOnError, setData, setError, safeDispatch]\n  );\n  return {\n    isIdle: state.stat === \"idle\",\n    isSuccess: state.stat === \"success\",\n    isError: state.stat === \"error\",\n    isLoading: state.stat === \"loading\",\n    run,\n    reTry,\n    setData,\n    setError,\n    ...state,\n  };\n};\n","import React, { ProfilerOnRenderCallback, ProfilerProps } from \"react\";\n\ntype Props = { metadata?: any; phases?: (\"mount\" | \"update\")[] } & Omit<\n  ProfilerProps,\n  \"onRender\"\n>;\n\nlet queue: unknown[] = [];\n\nconst sendProfileQueue = () => {\n  if (!queue.length) {\n    return;\n  }\n  const queueToSend = [...queue];\n  queue = [];\n  console.log(queueToSend);\n};\n\nsetInterval(sendProfileQueue, 5000);\n\nexport const Profiler = ({ metadata, phases, ...props }: Props) => {\n  const reportProfile: ProfilerOnRenderCallback = (\n    id,\n    phase,\n    actualDuration,\n    baseDuration,\n    startTime,\n    commitTime,\n    interactions\n  ) => {\n    if (!phases || phases.includes(phase)) {\n      queue.push({\n        id,\n        phase,\n        actualDuration,\n        baseDuration,\n        startTime,\n        commitTime,\n        interactions,\n        metadata,\n      });\n    }\n  };\n\n  return <React.Profiler onRender={reportProfile} {...props} />;\n};\n","import React, { Component } from \"react\";\n\ntype FallbackRender = (props: { error: Error | null }) => React.ReactElement;\n\nclass ErrorBoundary extends Component<\n  React.PropsWithChildren<{ fallbackRender: FallbackRender }>,\n  { error: Error | null }\n> {\n  state = { error: null };\n  static getDerivedStateFromError(error: Error) {\n    return error;\n  }\n  render() {\n    const { error } = this.state;\n    const { fallbackRender, children } = this.props;\n    if (error) return fallbackRender({ error });\n    return children;\n  }\n}\n\nexport default ErrorBoundary;\n","import React from \"react\";\nimport { useAuth } from \"context/auth-context\";\nimport ErrorBoundary from \"components/ErrorBoundary\";\nimport { FullPageErrorFallback, FullPageLoading } from \"components/lib\";\n// import {ErrorBoundary} from 'react-error-boundary'\nimport \"App.css\";\n\nconst Authenticated = React.lazy(() => import(\"Authenticated\"));\nconst Unauthenticated = React.lazy(() => import(\"Screens/Unauthenticated\"));\n\nfunction App() {\n  const { user } = useAuth();\n  return (\n    <div className=\"App\">\n      <ErrorBoundary fallbackRender={FullPageErrorFallback}>\n        <React.Suspense fallback={FullPageLoading}>\n          {user ? <Authenticated /> : <Unauthenticated />}\n        </React.Suspense>\n      </ErrorBoundary>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from \"web-vitals\";\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import { AuthProvider } from \"context/auth-context\";\nimport React, { ReactNode } from \"react\";\nimport { QueryClient, QueryClientProvider } from \"react-query\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\n\nexport const AppProvider = ({ children }: { children: ReactNode }) => {\n  const queryClient = new QueryClient({\n    defaultOptions: {\n      queries: {\n        refetchOnWindowFocus: false,\n      },\n    },\n  });\n  return (\n    <QueryClientProvider client={queryClient}>\n      <Router>\n        <AuthProvider>{children}</AuthProvider>\n      </Router>\n    </QueryClientProvider>\n  );\n};\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"App\";\nimport reportWebVitals from \"reportWebVitals\";\nimport { DevTools, loadServer } from \"jira-dev-tool\";\nimport \"antd/dist/antd.less\";\nimport { AppProvider } from \"context\";\nimport { Profiler } from \"components/Profiler\";\n\nloadServer(() => {\n  ReactDOM.render(\n    <React.StrictMode>\n      <Profiler id={\"Root App\"} phases={[\"mount\"]}>\n        <AppProvider>\n          <DevTools />\n          <App />\n        </AppProvider>\n      </Profiler>\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n  );\n});\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import { User } from \"types/user\";\n\nconst API = process.env.REACT_APP_API_URL;\nconst localStorageKey = \"__auth_provider_token__\";\n\n// 获取用户token\nexport const token = () => window.localStorage.getItem(localStorageKey);\n\n// 保存用户token\nexport const handleUserResponse = ({ user }: { user: User }) => {\n  window.localStorage.setItem(localStorageKey, user.token || \"\");\n  return user;\n};\n\n// 注册\nexport const register = (params: { username: string; password: string }) => {\n  return fetch(`${API}/register`, {\n    method: \"post\",\n    headers: {\n      \"Content-type\": \"application/json\",\n    },\n    body: JSON.stringify(params),\n  }).then(async (res) => {\n    if (res.ok) {\n      return handleUserResponse(await res.json());\n    } else {\n      return Promise.reject(await res.json());\n    }\n  });\n};\n\n// 登陆\nexport const login = (params: { username: string; password: string }) => {\n  return fetch(`${API}/login`, {\n    method: \"post\",\n    headers: {\n      \"Content-type\": \"application/json\",\n    },\n    body: JSON.stringify(params),\n  }).then(async (res) => {\n    if (res.ok) {\n      return handleUserResponse(await res.json());\n    } else {\n      return Promise.reject(await res.json());\n    }\n  });\n};\n\n// 登出\nexport const logout = async () =>\n  window.localStorage.removeItem(localStorageKey);\n","import { Spin, Typography, Button } from \"antd\";\nimport styled from \"styled-components\";\nimport { DevTools } from \"jira-dev-tool\";\n\nexport const Row = styled.div<{\n  gap?: number | boolean;\n  between?: boolean;\n  marginBottom?: number;\n}>`\n  display: flex;\n  align-items: center;\n  justify-content: ${(props) => (props.between ? \"space-between\" : undefined)};\n  margin-bottom: ${(props) => props.marginBottom + \"rem\"};\n\n  & > * {\n    margin-top: 0 !important;\n    margin-bottom: 0 !important;\n    margin-right: ${(props) =>\n      typeof props.gap === \"number\"\n        ? props.gap + \"rem\"\n        : props.gap\n        ? \"2rem\"\n        : undefined};\n  }\n`;\n\nconst FullPage = styled.div`\n  height: 100vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\n\nexport const FullPageLoading = () => (\n  <FullPage>\n    <Spin size={\"large\"}></Spin>\n  </FullPage>\n);\n\nexport const FullPageErrorFallback = ({ error }: { error: Error | null }) => (\n  <FullPage>\n    <DevTools />\n    <ErrorBox error={error} />\n  </FullPage>\n);\n\nconst isError = (value: any): value is Error => value?.message;\n\nexport const ErrorBox = ({ error }: { error: unknown }) => {\n  if (isError(error)) {\n    return <Typography.Text type={\"danger\"}>{error.message}</Typography.Text>;\n  }\n  return null;\n};\n\nexport const ButtonNoPadding = styled(Button)`\n  padding: 0;\n`;\n\nexport const ScreenContainer = styled.div`\n  padding: 3.2rem;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n`;\n","import React, { useContext } from \"react\";\nimport * as auth from \"auth-provider\";\nimport { User } from \"types/user\";\nimport { http } from \"utils/http\";\nimport { useMount } from \"utils\";\nimport { useAsync } from \"utils/useAsync\";\nimport { FullPageLoading, FullPageErrorFallback } from \"components/lib\";\nimport { useQueryClient } from \"react-query\";\n\ninterface Authform {\n  username: string;\n  password: string;\n}\n\nconst bootstrapUser = async () => {\n  let user = null;\n  const token = auth.token();\n  if (token) {\n    const data = await http(\"me\", { token });\n    user = data.user;\n  }\n  return user;\n};\n\nconst AuthContext = React.createContext<\n  | {\n      user: User | null;\n      login: (form: Authform) => Promise<void>;\n      register: (form: Authform) => Promise<void>;\n      logout: () => Promise<void>;\n    }\n  | undefined\n>(undefined);\n\nAuthContext.displayName = \"AuthContext\";\n\nexport const AuthProvider = ({ children }: { children: React.ReactNode }) => {\n  const {\n    run,\n    isLoading,\n    isError,\n    isIdle,\n    error,\n    setData: setUser,\n    data: user,\n  } = useAsync<User | null>();\n  const queryClient = useQueryClient();\n  const login = (form: Authform) =>\n    auth.login(form).then((user) => setUser(user));\n  const register = (form: Authform) => auth.register(form).then(setUser); // setUser === (user => setUser(user)) 消除参数\n  const logout = () =>\n    auth.logout().then(() => {\n      setUser(null);\n      queryClient.clear();\n    });\n  useMount(() => {\n    run(bootstrapUser());\n  });\n  if (isLoading || isIdle) return <FullPageLoading />;\n  if (isError) return <FullPageErrorFallback error={error} />;\n  return (\n    <AuthContext.Provider\n      children={children}\n      value={{ user, login, register, logout }}\n    />\n  );\n};\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) throw new Error(\"useAuth必须在AuthProvider中使用\");\n  return context;\n};\n"],"sourceRoot":""}